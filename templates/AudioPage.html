<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vue自动对话聊天窗口特效</title>

    <link rel="stylesheet" href="../static/chatPage/style.css">
    <script src="../static/chatPage/jquery.js"></script>

</head>
<body>
<!-- partial:index.partial.html -->
<div id="app" class="container">
    <div id="wrapper" class="chat-wrapper">
        <bubble
                v-for="content in contents"
                v-bind:bubbtext="content.text"
                v-bind:class="content.isUser ? 'bubble-right' : 'bubble-left'"
        >
        </bubble>
        <div v-show="isTyping" class="bubble bubble-right bubble-thinking">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
        </div>
        <div v-show="isThinking" class="bubble bubble-left bubble-thinking">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
        </div>

        <p v-if="noResponses" class="small disabled">User has left the chat. ☹️</p>
    </div>



    <div class="chat-input">
        <input
                v-on:keyup.enter="addToChat"
                v-model="newMessage"
                type="text"
                name="chatText"
                id="chatText"
                class="input-control input-text"
                placeholder="Type a message"
        />
        <button v-on:click="addToChat" class="input-control input-button" >Send</button>
        <button onclick="interact()" id="fang">on</button>
    </div>
    
    <div>
        <audio class="audio"  id="music" src="../static/826.wav"   ></audio>
    </div>
</div>




<!-- partial -->
<script src='../static/chatPage/vue.min.js'></script>
<script src="../static/chatPage/script.js"></script>
<script>
    function interact(object) {

        var audioEle = document.getElementById("music");
        var xhr = new XMLHttpRequest();
        xhr.open("get", "/mp3", true)
        // xhr.responseType="blob"
        xhr.responseType = "arraybuffer"
        xhr.send(null)
        var kfc;
        var arr = [];
        xhr.onload = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                // 4 = "loaded" && 200 =  ok
                console.log(xhr)
                // console.log(xhr.response)  //不加
                // responseType="arraybuffer"
                // 或者blob，会很卡，一大堆乱码
                arr.push(xhr.response)
                console.log(arr)
                // var blob=new Blob([xhr.response])
                var blob = new Blob(arr)
                console.log(blob)
                kfc = window.URL.createObjectURL(blob)
                console.log(kfc)
                audioEle.src = kfc
                {#audioEle.load()#}
                audioEle.play()
            }
        }
    }


</script>

</body>
</html>
