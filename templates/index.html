<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Home Page</title>
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/style.css">
    <link rel="stylesheet" href="../static/chatPage/style.css">
    <link rel="shortcut icon" href="../static/TemplateData/favicon.ico">
    <link rel="stylesheet" href="{{ url_for('static', filename='TemplateData/style.css') }}">
    <link rel="stylesheet" href="../static/css/driver.min.css">
    <link href="./static/fonts/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=DM+Sans:400,500,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../static/css/loading.css">
    <script>
        let transferToUnity = "";
        var start = 0;
    </script>
</head>
<body>
<div class="loading-container">
    <section>
        <div class="loader loader-1">
            <div class="loader-outter"></div>
            <div class="loader-inner"></div>
        </div>
    </section>
</div>
<div id="home-container">
    <div id="mydesk"></div>
    <div class="app-container row">
        <button class="mode-switch">
            <svg class="sun" fill="none" stroke="#fbb046" stroke-linecap="round" stroke-linejoin="round"
                 stroke-width="2"
                 class="feather feather-sun" viewBox="0 0 24 24">
                <defs/>
                <circle cx="12" cy="12" r="5"/>
                <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
            </svg>
            <svg class="moon" fill="none" stroke="#ffffff" stroke-linecap="round" stroke-linejoin="round"
                 stroke-width="2"
                 class="feather feather-moon" viewBox="0 0 24 24">
                <defs/>
                <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
            </svg>
        </button>
        <div class="app-main col-md-6 col-sm-12 col-md-offset-2">
            <div class="video-call-wrapper" id="wrapper">
                <div id="unity-container" class="unity-desktop">
                    <canvas id="unity-canvas"></canvas>
                    <div id="unity-loading-bar">
                        <div id="unity-logo"></div>
                        <div id="unity-progress-bar-empty">
                            <div id="unity-progress-bar-full"></div>
                        </div>
                    </div>
                    <div id="unity-mobile-warning">
                        WebGL builds are not supported on mobile devices.
                    </div>
                </div>
            </div>
            <div class="video-call-actions">
                <div id="sub-container">
                    <button class="video-action-button fa fa-bell-slash-o fa-lg"
                            onclick="StopPlayback()" id="mute" data-toggle="popover" trigger="hover"
                            title="Mute Button"
                            data-content="If you want him to stop talking, please click here！"></button>
                    <button class="video-action-button fa fa-map-o fa-lg" id="guide" data-toggle="popover"
                            trigger="hover"
                            title="Guide"
                            data-content="You can know core functions about our website by clicking here!"></button>
                    <a href="/about-us" id="about-us">
                        <button class="video-action-button fa fa-group fa-lg" data-toggle="popover"
                                trigger="hover"
                                title="About Us"
                                data-content="You can know the details of our product and our team members by clicking here!"></button>
                    </a>
                    <button class="video-action-button fa fa-expand" id="unity-fullscreen-button" data-toggle="popover"
                            trigger="hover"
                            title="Full Screen"
                            data-content="You can immerse in VR World by clicking here!"></button>
                </div>
            </div>
        </div>
        <div class="right-side col-md-2">
            <button class="btn-close-right">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor"
                     stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="feather feather-x-circle"
                     viewBox="0 0 24 24">
                    <defs></defs>
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M15 9l-6 6M9 9l6 6"></path>
                </svg>
            </button>
            <div class="ui-wrapper">
                <div id="app" class="container-">
                    <div id="chat-wrapper" class="chat-wrapper">
                        <bubble
                                v-for="content in contents"
                                v-bind:bubbtext="content.text"
                                v-bind:class="content.isUser ? 'bubble-right' : 'bubble-left'"
                        >
                        </bubble>
                        <div v-show="isTyping" class="bubble bubble-right bubble-thinking">
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                        </div>
                        <div v-show="isThinking" class="bubble bubble-left bubble-thinking">
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                        </div>
                        <p v-if="noResponses" class="small disabled">User has left the chat. ☹️</p>
                    </div>
                    <div class="chat-typing-area-wrapper">
                        <button class="video-action-button mic fa fa-microphone-slash fa-lg" id="fang"
                                style="position: relative;right: 21px;bottom: -60px"></button>
                        <div class="chat-input">
                            <textarea
                                    v-on:keyup.enter="addToChat"
                                    v-model="newMessage"
                                    type="text"
                                    name="chatText"
                                    id="chatText"
                                    class="input-control input-text cognitive"
                                    placeholder="Type a message"
                                    style="resize: none"
                            >
                        </textarea>
                            <button v-on:click="addToChat" class="input-button" onclick="zero()">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor"
                                     stroke-width="2"
                                     stroke-linecap="round" stroke-linejoin="round"
                                     class="feather feather-send send-button"
                                     viewBox="0 0 24 24">
                                    <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <button class="expand-btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 class="feather feather-message-circle">
                <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
            </svg>
        </button>
    </div>
</div>
<script src='../static/js/jquery.min.js'></script>
<script src="../static/js/script.js"></script>
<script src='../static/chatPage/vue.min.js'></script>
<script src="../static/js/bootstrap.min.js"></script>
<script src="../static/microsoft.cognitiveservices.speech.sdk.bundle.js"></script>
<script src="../static/js/cognitive.js"></script>
<script>
    var myUnityInstance = null;
    var buildUrl = "{{ url_for('static', filename='Build') }}";
    var loaderUrl = buildUrl + "/Project-Test.loader.js";
    var config = {
        dataUrl: buildUrl + "/Project-Test.data",
        frameworkUrl: buildUrl + "/Project-Test.framework.js",
        codeUrl: buildUrl + "/Project-Test.wasm",
        streamingAssetsUrl: "{{ url_for('static', filename='StreamingAssets') }}",
        companyName: "DefaultCompany",
        productName: "off-axis-projection",
        productVersion: "0.1",
    };
    var container = document.querySelector("#unity-container");
    var canvas = document.querySelector("#unity-canvas");
    var loadingBar = document.querySelector("#unity-loading-bar");
    var progressBarFull = document.querySelector("#unity-progress-bar-full");
    var fullscreenButton = document.querySelector("#unity-fullscreen-button");
    var mobileWarning = document.querySelector("#unity-mobile-warning");

    // By default Unity keeps WebGL canvas render target size matched with
    // the DOM size of the canvas element (scaled by window.devicePixelRatio)
    // Set this to false if you want to decouple this synchronization from
    // happening inside the engine, and you would instead like to size up
    // the canvas DOM size and WebGL render target sizes yourself.
    // config.matchWebGLToCanvasSize = false;

    if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        container.className = "unity-mobile";
        // Avoid draining fillrate performance on mobile devices,
        // and default/override low DPI mode on mobile browsers.
        config.devicePixelRatio = 1;
        mobileWarning.style.display = "block";
        setTimeout(() => {
            mobileWarning.style.display = "none";
        }, 5000);
    } else {
        canvas.style.width = "900px";
        canvas.style.height = "562.5px";
    }
    loadingBar.style.display = "block";

    var script = document.createElement("script");
    script.src = loaderUrl;
    script.onload = () => {
        createUnityInstance(canvas, config, (progress) => {
            progressBarFull.style.width = 100 * progress + "%";
        }).then((unityInstance) => {
            myUnityInstance = unityInstance;
            loadingBar.style.display = "none";
            fullscreenButton.onclick = () => {
                unityInstance.SetFullscreen(1);
            };
        }).catch((message) => {
            alert(message);
        });
    };
    document.body.appendChild(script);
</script>
<script src="../static/chatPage/script.js"></script>
<script src="../static/js/driver.min.js"></script>
<script>
    $("#fang").on("click", function () {
        ChangeUseableCondition();

        /*

        // doContinuousRecognition();*/
        // $('#fang').disabled();
        // alert("多行注释");

    })

    // $("#wave-hand").on("click", function () {
    //     myUnityInstance.SendMessage("EventSystem", "WaveHand");
    // })

    $("#guide").on("click", function () {
        setTimeout(() => {
            driver.start()
        })
    })
</script>
<script>
    const driver = new Driver({
        doneBtnText: 'Finished', // 结束按钮的文字
        stageBackground: '#ffffff', // 突出显示元素的背景颜色
        nextBtnText: 'Next', // 下一步按钮的文字
        prevBtnText: 'Previous', // 上一步按钮的文字
        closeBtnText: 'Close', // 关闭按钮的文字
        onHighlightStarted: Element => {
        }, // 元素即将突出显示时调用
        onHighlighted: Element => {
        }, // 元素完全突出显示时调用
        onDeselected: Element => {
        }, // 取消选择元素时调用
        onReset: Element => {
        }, // 当要清除叠加时调用
        onNext: Element => {
        }, // 在任何步骤中移动到下一步时调用
        onPrevious: Element => {
        } // 在任何步骤中移动到上一步时调用
    });
    const steps = [
        {
            element: '#unity-canvas',
            popover: {
                title: 'Fish Tank VR',
                description: 'Hi, Welcome to our website, you can see whatever you want without wearing any VR equipment!',
                position: 'right' // 可选 `top`, `left`, `right`, `bottom`
            }
        },
        {
            element: '#sub-container',
            popover: {
                title: 'Main Menu',
                description: 'You can find all core functions here, including voice generation and full screen!',
                position: 'top' // 可选 `top`, `left`, `right`, `bottom`
            }
        },
        {
            element: '#mute',
            popover: {
                title: 'Mute Button',
                description: 'If you want him to stop talking, please click here！',
                position: 'top' // 可选 `top`, `left`, `right`, `bottom`
            }
        },
        // {
        //     element: '#wave-hand',
        //     popover: {
        //         title: 'Wave Hand',
        //         description: 'Click here and he will greet you kindly!',
        //         position: 'top' // 可选 `top`, `left`, `right`, `bottom`
        //     }
        // },
        {
            element: '#guide',
            popover: {
                title: 'Guide',
                description: 'You can know core functions about our website by clicking here!',
                position: 'top' // 可选 `top`, `left`, `right`, `bottom`
            }
        },
        {
            element: '#about-us',
            popover: {
                title: 'About Us',
                description: 'You can know the details of our product and our team members by clicking here!',
                position: 'top' // 可选 `top`, `left`, `right`, `bottom`
            }
        },
        {
            element: '#unity-fullscreen-button',
            popover: {
                title: 'Full Screen',
                description: 'You can immerse in VR World by clicking here!',
                position: 'top' // 可选 `top`, `left`, `right`, `bottom`
            }
        },
        {
            element: '.right-side',
            popover: {
                title: 'Chat Box',
                description: 'You can chat with me by typing the question you want to ask!',
                position: 'left' // 可选 `top`, `left`, `right`, `bottom`
            }
        },
    ]
    driver.defineSteps(steps)
</script>
<script>
    $(window).on("load", function () {
        setTimeout(function () {
            $(".loading-container").fadeOut(1000, function () {
                $(".loading-container").css('display', "none")
            });
        }, 5000);
        //页面属性，图片，内容完全加载完，执行
        setTimeout(function () {
            $("#home-container")
                .css('display', "inline")
        }, 5000);
    })
    $(function () {
        $("[data-toggle='popover']").popover({trigger: "hover", placement: "top", color: "black"});
    });
</script>
<style>
    #home-container {
        display: none;
    }

    .row {
        margin: 0;
    }

    #about-us {
        color: black;
    }
</style>
</body>
</html>
